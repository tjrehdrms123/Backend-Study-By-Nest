![](https://lime-demo.s3.amazonaws.com/posts/1678636171376_32305_27384_5151.jpg)

# [ 코드 리뷰 ] 설문 DB 설계
![20230320_183636.png](https://lime-demo.s3.amazonaws.com/posts/1679305019020_20230320_183636.png)
> 해당 설문지는 구글 강의 설문지 입니다.

> 구글 설문지를 커스텀하게 구현하려고했을때 막혔던 DB 테이블 설계에 대해 공유해보려고합니다. 
> 위 설문지 이미지를 보면 문제 안에 답안이 속해 있습니다 왜냐하면 문제 없이 답안이 존재할 수 없기 때문이죠.
```markdown
문제: 평소에 물을 잘 마시나요?
답안: 잘마십니다, 보통입니다, 잘 안마십니다
```

## 설문 답안을 어떻게 만들것인가?
> 설계 했을때 2가지 방안이 있었습니다.
1. 배열로 만들기
- 수정과 삭제를 했을때 관리가 어렵기 때문에 해당 방식으로 진행하지 않았습니다.
- 배열로 데이터를 관리하면 가져다 쓸때 꼬일수 있습니다. 예외 상황이 많습니다.
  - 2번째 원소 보통입니다를 제거하려고했을때
  - 아무값도 없을때
  - 원소끼리의 구분 처리(예시에서는 ,로 구분)등
```markdown
ex) 
[잘마십니다, 보통입니다, 잘 안마십니다]
```

2. 1:1로 연결하기(문제하나당 답안 하나씩)
- 작업하려고 했을때 아래와 같은 문제점이 있었습니다.

## 2번을 구현하려고 했을때 foreign key를 부모 테이블(문제)에 설정했을때 문제점
> 설문을 만들려고했을떄의 예시 상황
- 답안을 자식 테이블에서 가져오기 위해서 부모 테이블의 답안`Columns`을 고정 갯수로 설정해야되는 문제점이 있습니다.
- 구현했을때 설문 문제 테이블 안에는 설문 문제와 연결되어있는 답안의 고유 키가 있을 것 입니다.
```mysql
# 설문 문제 테이블에서 답안 테이블의 `PK id`를 갖고 있어서 `foreign key`로 연결해서 사용
SELECT ... FROM `설문 문제 테이블` WHERE `설문 문제 테이블.foreignKey = 설문 답안 테이블.id`
```

## 2번을 구현하려고 했을때 foreign key를 답안 테이블의 마다 연결해서 구현
> 문제 안에 답안이 속해 있다는 관념을 버리고 답안 테이블을 부모 테이블로 지정해서 1:1 관계 구현
```markdown
ex) 문제 테이블
1: 평소에 물을 잘 마시나요?
2: 평소에 음료를 잘 마시나요?

ex) 답안 테이블
잘마십니다: 1
보통입니다: 1
잘마십니다: 2
보통입니다: 2
```

## 생각 정리
> 연관 관계가 있는 테이블을 설계할때 구현 방법에 따라 부모 테이블이 자식 테이블로 자식 테이블이 부모테이블로 역전 될 수도 있구나를 알게 됐습니다.